# 🔍 プロジェクト分析

プロジェクトの現状を詳細に分析し、改善点や最適化機会を特定します。

**使用法**: `/analyze [scope] [options]`

---

## 📋 分析スコープ

### `/analyze` または `/analyze all`
プロジェクト全体の包括的分析を実行

### `/analyze code`
コード品質とアーキテクチャに特化した分析

### `/analyze performance`
パフォーマンスとリソース使用状況の分析

### `/analyze security`
セキュリティ脆弱性と安全性の分析

### `/analyze dependencies`
依存関係とライブラリの分析

### `/analyze documentation`
ドキュメントの整備状況分析

### `/analyze tests`
テストカバレッジと品質の分析

---

## 🎯 実行内容

引数 `$ARGUMENTS` に基づいて以下を実行:

### Phase 1: 分析スコープ決定
```text
引数解析:
- スコープ指定がない場合: 全体分析を実行
- 特定スコープ指定: 該当領域に特化した深掘り分析
- オプション解析: 出力形式、詳細レベル、エクスポート設定

分析戦略決定:
- 静的解析 vs 動的解析
- 自動分析 vs 手動調査
- 高速分析 vs 詳細分析
```

### Phase 2: データ収集
```text
@task-parallel data-collection
- task_id: static-analysis
  description: |
    ソースコード静的解析実行
    - コード複雑度測定
    - 重複コード検出
    - アーキテクチャパターン分析
    
- task_id: dependency-analysis
  description: |
    依存関係分析実行
    - パッケージ構成調査
    - 脆弱性スキャン
    - ライセンス確認
    
- task_id: git-history-analysis
  description: |
    Git履歴分析実行
    - コミット頻度パターン
    - ホットスポット特定
    - 開発活動傾向

- task_id: performance-metrics
  description: |
    パフォーマンス指標収集
    - ビルド時間測定
    - バンドルサイズ分析
    - 実行時パフォーマンス
@end-parallel
```

### Phase 3: 分析処理
```text
collected_data_processing:
1. データ正規化と統合
2. パターン認識と異常検出
3. ベストプラクティスとの照合
4. 改善機会の特定
5. 優先度付けと影響度評価
```

### Phase 4: レポート生成
```text
analysis_report_generation:
1. エグゼクティブサマリー作成
2. 詳細分析結果整理
3. 実行可能な改善提案作成
4. 視覚的なダッシュボード生成
5. 継続監視項目の特定
```

---

## 📊 分析レポート形式

### 🎯 全体分析レポート
```markdown
# プロジェクト分析レポート

## 📈 エグゼクティブサマリー
- **プロジェクト健全性スコア**: A- (85/100)
- **主要改善領域**: パフォーマンス、テストカバレッジ
- **推定改善工数**: 20-30時間
- **期待ROI**: 開発効率25%向上

## 🔍 詳細分析結果

### コード品質 (B+)
- **複雑度**: 平均7.2 (良好)
- **重複コード**: 3.4% (許容範囲)
- **技術的負債**: 中程度 (18箇所)

**改善提案**:
1. `src/utils/dataProcessor.ts` のリファクタリング (複雑度22)
2. 共通ユーティリティ関数の統合 (5箇所で重複)
3. 型定義の強化 (any型の削減)

### パフォーマンス (C+)
- **ビルド時間**: 3.2分 (改善必要)
- **バンドルサイズ**: 2.8MB (大きい)
- **初期読み込み**: 4.1秒 (改善必要)

**改善提案**:
1. 動的インポートによるコード分割
2. 未使用依存関係の除去 (12パッケージ)
3. 画像最適化とlazy loading

### セキュリティ (A)
- **脆弱性**: 0件 (良好)
- **依存関係**: 最新版 (良好)
- **設定**: セキュア (良好)

### テスト (C)
- **カバレッジ**: 67% (改善必要)
- **テスト品質**: 中程度
- **E2Eテスト**: 不足

**改善提案**:
1. 重要機能のテスト追加 (認証、決済)
2. E2Eテストスイート構築
3. テスト自動化の改善

## 🎯 優先改善タスク

### 高優先度 (即座に実行)
1. **セキュリティパッチ適用** (工数: 30分)
2. **クリティカルバグ修正** (工数: 2時間)
3. **パフォーマンスボトルネック解消** (工数: 4時間)

### 中優先度 (今週中)
1. **テストカバレッジ向上** (工数: 8時間)
2. **コード品質改善** (工数: 6時間)
3. **ドキュメント更新** (工数: 3時間)

### 低優先度 (今月中)
1. **依存関係整理** (工数: 4時間)
2. **アーキテクチャリファクタリング** (工数: 12時間)
3. **開発ツール改善** (工数: 6時間)

## 📋 自動生成可能なISSUE

基準を満たすタスク (明確度80%以上、工数4時間以内):

1. **[AUTO] パフォーマンス最適化: バンドルサイズ削減**
   - 工数: 3時間
   - 影響: 高
   - 実装可能性: 高

2. **[AUTO] テスト追加: 認証システムのテストカバレッジ向上**
   - 工数: 4時間
   - 影響: 中
   - 実装可能性: 高

3. **[AUTO] コード品質: 共通ユーティリティ関数統合**
   - 工数: 2時間
   - 影響: 中
   - 実装可能性: 高

## 📊 継続監視指標

- **週次チェック**: テストカバレッジ、ビルド時間
- **月次チェック**: 依存関係、セキュリティスキャン
- **四半期チェック**: アーキテクチャ健全性、技術的負債
```

### 🔧 特化分析レポート例

#### パフォーマンス分析
```markdown
# パフォーマンス分析レポート

## 📊 現状指標
- **First Contentful Paint**: 2.1秒
- **Largest Contentful Paint**: 4.8秒
- **Time to Interactive**: 5.2秒
- **Bundle Size**: 2.8MB
- **Build Time**: 3.2分

## 🎯 最適化機会

### Critical (即座対応)
1. **大きなライブラリの動的読み込み** (-40% Bundle Size)
2. **画像最適化** (-60% 画像読み込み時間)
3. **不要CSS除去** (-25% スタイルファイルサイズ)

### High (今週中)
1. **コード分割実装** (-30% 初期Bundle Size)
2. **Service Worker導入** (+40% リピート訪問速度)
3. **リソースプリロード最適化** (-20% 表示時間)

### Medium (今月中)
1. **サーバーサイド最適化** (+15% API応答速度)
2. **CDN設定最適化** (-30% 静的リソース読み込み)
3. **データベースクエリ最適化** (-50% データ取得時間)

## 🛠️ 実行可能タスク
1. `/task "大きなライブラリを動的インポートに変更"`
2. `/task "画像ファイルを最適化してlazy loading実装"`
3. `/task "未使用CSSを検出して除去"`
```

---

## ⚙️ 分析設定

### 分析深度設定
```yaml
analysis_config:
  depth_level: "standard"  # quick | standard | deep
  include_patterns:
    - "src/**/*"
    - "tests/**/*"
    - "docs/**/*"
  exclude_patterns:
    - "node_modules/**"
    - "dist/**"
    - "coverage/**"
    
quality_thresholds:
  code_complexity_max: 15
  duplication_threshold: 5%
  test_coverage_min: 80%
  security_risk_max: "medium"
  
reporting:
  format: "markdown"  # markdown | json | html
  include_charts: true
  export_metrics: true
  generate_issues: true
```

### 分析ツール統合
```yaml
analysis_tools:
  static_analysis:
    - eslint
    - sonarqube
    - codeclimate
    
  security_scanning:
    - snyk
    - npm_audit
    - bandit
    
  performance:
    - lighthouse
    - webpack_bundle_analyzer
    - size_limit
    
  documentation:
    - typedoc
    - jsdoc
    - readme_score
```

---

## 🚀 分析後のアクション

### 自動ISSUE生成
```text
analysis_to_issues:
1. 改善提案から実行可能タスクを抽出
2. 工数・影響度・実装可能性でフィルタリング
3. 適切な優先度とラベルでISSUE作成
4. 自動的にプロジェクトボードに追加

generation_criteria:
- 明確度スコア >= 80%
- 推定工数 <= 8時間
- 実装可能性 >= 70%
- ビジネス影響度 >= 中
```

### 継続監視設定
```text
monitoring_setup:
1. 重要指標の自動追跡設定
2. 閾値超過時のアラート設定  
3. 週次/月次レポート自動生成
4. 改善効果の測定と追跡

dashboard_creation:
- リアルタイム品質指標
- トレンド分析グラフ
- 改善進捗追跡
- 比較レポート機能
```

---

## 🎨 使用例

### 例1: 包括的プロジェクト分析
```bash
/analyze

# 結果: 全領域の健全性チェック
# 時間: 10-15分
# 出力: 包括レポート + 改善タスクリスト
```

### 例2: パフォーマンス特化分析
```bash
/analyze performance --export=json

# 結果: パフォーマンス詳細分析
# 時間: 5-10分
# 出力: パフォーマンスレポート + JSON データ
```

### 例3: セキュリティ監査
```bash
/analyze security --deep

# 結果: 詳細セキュリティ分析
# 時間: 15-20分
# 出力: セキュリティレポート + 脆弱性一覧
```

---

この分析システムにより、プロジェクトの現状を客観的に把握し、データドリブンな改善計画を立てることができます。