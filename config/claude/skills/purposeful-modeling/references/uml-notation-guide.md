# 視点別UML記法ガイド

各モデリング視点でのUML記法の使い方を定義する。

## 目次

- 記法使用マトリクス
- クラス図
- ユースケース図
- シーケンス図/コラボレーション図
- アクティビティ図
- ステートチャート図
- 一般的な記法ガイドライン

---

## 記法使用マトリクス

| 図の種類 | 概念 | 仕様 | 実装 |
|---------|------|------|------|
| ユースケース | — | ソフトウェア境界の相互作用 | — |
| クラス | 情報モデル | オブジェクト構造 | オブジェクト構造 |
| シーケンス/コラボレーション | — | 必要なオブジェクト相互作用 | 設計されたオブジェクト相互作用 |
| アクティビティ | 業務プロセス | — | — |
| ステートチャート | イベント順序制約 | メッセージ順序制約 | イベント/応答定義 |

**凡例**: 「—」はその視点では通常使用しないことを示す。

---

## クラス図

クラス図は最も汎用的であり、そのため最も混乱を招きやすい。同じ記法が根本的に異なる目的に使われる。

### 概念クラス図

**目的**: 問題ドメインの情報構造を文書化する。

**使用する要素**:
- ドメインエンティティを表す `<<concept>>` としてのクラス
- 現実世界の関係を示す関連
- ドメインに関連する情報を表す属性
- 動的サブタイピング（エンティティが型を変更可能）

**避ける要素**:
- メソッド（振る舞いの詳細）
- 外部キーやID
- ナビゲーション方向
- 可視性修飾子

**例**:
```
┌────────────────────────┐
│    <<concept>>         │
│       Order            │
├────────────────────────┤
│ deliveryCharge: Money  │
└────────────────────────┘
          △
          │
┌────────────────────────┐
│    <<concept>>         │
│     UrgentOrder        │
├────────────────────────┤
│ <<dynamic>>            │
│ deliveryCharge: Money  │
└────────────────────────┘
```

### 仕様クラス図

**目的**: 必要なオブジェクト構造とその契約を定義する。

**使用する要素**:
- 振る舞いの契約を表す `<<type>>` としての型
- 必要な操作を定義するインターフェース
- 型付き属性
- シグネチャ付き操作（実装ではない）

**避ける要素**:
- 実装の詳細
- プライベートメンバー
- デザインパターン構造
- 技術的ユーティリティ

**例**:
```
┌────────────────────────┐
│      <<type>>          │
│       Order            │
├────────────────────────┤
│ deliveryCharge: Money  │
│ isUrgent: Boolean      │
├────────────────────────┤
│ beUrgent()             │
└────────────────────────┘
```

### 実装クラス図

**目的**: 実際のコード構造と設計決定を文書化する。

**使用する要素**:
- 完全なシグネチャを持つクラス
- すべての可視性修飾子
- デザインパターンを明示的に表示
- ナビゲーション可能性を持つ依存関係と関連
- 実装継承

**例**:
```
┌────────────────────────┐       ┌─────────────────────────┐
│      <<class>>         │       │       <<class>>         │
│       Order            │──────►│   DeliveryStrategy      │
├────────────────────────┤   1   ├─────────────────────────┤
│ deliveryCharge(): Money│       │ getCharge(): Money      │
│ isUrgent(): Boolean    │       └─────────────────────────┘
│ beUrgent()             │                   △
└────────────────────────┘                   │
                                  ┌──────────┴──────────┐
                          ┌──────┴──────┐      ┌──────┴──────┐
                          │<<class>>    │      │<<class>>    │
                          │RegularDel.  │      │UrgentDel.   │
                          ├─────────────┤      ├─────────────┤
                          │getCharge()  │      │getCharge()  │
                          └─────────────┘      └─────────────┘
```

---

## ユースケース図

### 仕様ユースケース図

**目的**: ソフトウェア境界とアクター相互作用を定義する。

**使用する要素**:
- 外部エンティティとしてのアクター
- システム機能としてのユースケース
- 明確にマークされたシステム境界
- ユースケース間の関係（include、extend）

**重要な原則**: ユースケースはシステムがアクターに対して「何を」するかを定義し、「どのように」するかではない。

---

## シーケンス図/コラボレーション図

### 仕様シーケンス図

**目的**: 実装詳細なしで必要なオブジェクト相互作用を定義する。

**使用する要素**:
- 抽象的な参加者（クラスではなく型）
- 必要なメッセージ（契約）
- ビジネスロジックの条件フロー

**避ける要素**:
- 実装固有のオブジェクト
- 技術的ユーティリティ
- 詳細なエラーハンドリング

### 実装シーケンス図

**目的**: 実際に設計された相互作用を文書化する。

**使用する要素**:
- 具象クラス
- すべてのメッセージパラメータ
- 戻り値
- オブジェクトのライフライン
- 実装の代替案

---

## アクティビティ図

### 概念アクティビティ図

**目的**: 業務プロセスとワークフローをモデル化する。

**使用する要素**:
- 業務ステップとしてのアクティビティ
- 組織的役割のスイムレーン
- ビジネスルールの決定ポイント
- 並行プロセスのパラレルフロー

**重要な原則**: ソフトウェア要素なし—純粋に業務プロセス。

---

## ステートチャート図

### 概念ステートチャート

**目的**: ドメインにおけるイベント順序制約を定義する。

**例**: ビジネスが理解する注文の状態。

### 仕様ステートチャート

**目的**: システムのメッセージ順序制約を定義する。

**例**: API呼び出しの有効なシーケンス。

### 実装ステートチャート

**目的**: コードのイベント/応答振る舞いを定義する。

**例**: コード内のステートマシン実装。

---

## 一般的な記法ガイドライン

### 視点別ステレオタイプ使用

| 視点 | ステレオタイプ |
|------|---------------|
| 概念 | `<<concept>>`, `<<domain>>`, `<<entity>>`, `<<dynamic>>` |
| 仕様 | `<<type>>`, `<<interface>>`, `<<service>>` |
| 実装 | `<<class>>`, `<<component>>`, `<<strategy>>` |

### 属性記法

| 視点 | 属性スタイル |
|------|-------------|
| 概念 | `attributeName: DomainType` |
| 仕様 | `attributeName: Type` |
| 実装 | `visibility attributeName: Type = default` |

### 操作記法

| 視点 | 操作スタイル |
|------|-------------|
| 概念 | ほとんど使用しない；代わりにプロセスフロー |
| 仕様 | `operationName(params): ReturnType` |
| 実装 | `visibility operationName(params): ReturnType` |

### 関係記法

| 視点 | 焦点 |
|------|------|
| 概念 | 現実世界の関係、多重度 |
| 仕様 | 必要な関連、契約 |
| 実装 | ナビゲーション、依存性注入、パターン |
